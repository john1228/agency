<script>
    $(function () {
        $('.dynamic_pagination a').on('click', function (event) {
            $.get(this.href, null, null, 'script');
            return false;
        });
        $('.delete_icon').on('click', function (event) {
            $.delete(this.href, function (data) {
                if (data.result) {
                    $(location).attr("href", '/dynamics');
                } else {
                    alert("删除失败，请重试");
                }

            });
            return false;
        })
    });
</script>
<div class="clearfix">
  <% @dynamics.each do |dynamic| %>
      <div class="pull-left ailois ">
        <a href="/dynamics/<%= dynamic.id %>">
          <% if dynamic.film.present? %>
              <div class="col-xs-12 col-md-12" id="HLSPlayer">
                <div class="video" id="HLSPlayer">
                  <SCRIPT LANGUAGE=JavaScript>
                      var vWidth = "100%";                //播放器宽度设置
                      var vHeight = 246;                   //播放器宽度设置
                      var vPlayer = "<%=asset_path('HLSPlayer.swf')%>?v=1.5"; //播放器文件
                      var vHLSset = "<%=asset_path('HLS.swf')%>";             //HLS配置
                      var vPic = "<%=(dynamic.film.cover.url rescue 'http://localhost/assets/default_dynamic.png')%>";    //视频缩略图
                      var vHLSurl = "<%=(dynamic.film.film.hls rescue 'http://b.cuplayer.net:8011/hls2-vod/test.mp4.m3u8')%>";
                      //-->
                  </SCRIPT>
                  <%= javascript_include_tag 'js/hls.min' %>
                </div>
              </div>
          <% else %>
              <div class="screenshot" style="background-image: url('<%=dynamic.images.first.image.thumb.url rescue ''%>');background-size: cover">
              </div>
          <% end %>
        </a>
        <dl class="polokl">
          <dd class="destion"><%= dynamic.created_at.localtime.strftime('%Y-%m-%d %H:%M') %></dd>
          <a href="/dynamics/<%= dynamic.id %>">
            <dd class="destion" style="height: 20px"><%= truncate(dynamic.content) %></dd>
          </a>
        </dl>
        <div class="clearfix polokl ">
          <a href="#" class="pull-left pritbt">
            <i class="iconfont icon">&#xe60e;</i><%= image_tag dynamic.user.profile.avatar.url(:thumb) %>
          </a>
          <a href="/dynamics/<%= dynamic.id %>" class="pull-right pritbt delete_icon"><i class="iconfont">&#xe60d;</i><%= dynamic.comments_count %></a>
        </div>
      </div>
  <% end %>
</div>
<div class="dataTables_paginate">
  <%= will_paginate @dynamics, renderer: BootstrapPagination::Rails, class: 'dynamic_pagination', inner_window: 2 %>
</div>